
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      <link rel="icon" href="../../assets/img/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.5">
    
    
      
        <title>First - AnnaDB</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/color_scheme.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="bright" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#basics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AnnaDB" class="md-header__button md-logo" aria-label="AnnaDB" data-md-component="logo">
      
  <img src="../../assets/img/small_icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AnnaDB
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              First
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../install/" class="md-tabs__link">
      Install
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../documentation/introduction/" class="md-tabs__link">
        Documentation
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorial/native/" class="md-tabs__link">
        Tutorial
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../release_notes/0.2.0/" class="md-tabs__link">
        Release Notes
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AnnaDB" class="md-nav__button md-logo" aria-label="AnnaDB" data-md-component="logo">
      
  <img src="../../assets/img/small_icon.svg" alt="logo">

    </a>
    AnnaDB
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        Install
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/data_types/" class="md-nav__link">
        Data Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/insert/" class="md-nav__link">
        Insert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/get/" class="md-nav__link">
        Get
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/find/" class="md-nav__link">
        Find
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/sort/" class="md-nav__link">
        Sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/limit/" class="md-nav__link">
        Limit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/offset/" class="md-nav__link">
        Offset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/update/" class="md-nav__link">
        Update
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/delete/" class="md-nav__link">
        Delete
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/native/" class="md-nav__link">
        Native
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Release Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release_notes/0.2.0/" class="md-nav__link">
        0.2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
    <nav class="md-nav" aria-label="Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collections" class="md-nav__link">
    Collections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tyson" class="md-nav__link">
    TySON
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-types" class="md-nav__link">
    Data Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query" class="md-nav__link">
    Query
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server" class="md-nav__link">
    Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client" class="md-nav__link">
    Client
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-example" class="md-nav__link">
    Usage example
  </a>
  
    <nav class="md-nav" aria-label="Usage example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#insert-primitive" class="md-nav__link">
    Insert primitive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert-container" class="md-nav__link">
    Insert container
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-object" class="md-nav__link">
    Get object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-primitive" class="md-nav__link">
    Modify primitive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-container" class="md-nav__link">
    Modify container
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sort-objects" class="md-nav__link">
    Sort objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-objects" class="md-nav__link">
    Delete objects
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-from-your-app" class="md-nav__link">
    Using from your app
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plans" class="md-nav__link">
    Plans
  </a>
  
    <nav class="md-nav" aria-label="Plans">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#drivers" class="md-nav__link">
    Drivers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rights-management" class="md-nav__link">
    Rights management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-increase" class="md-nav__link">
    Performance increase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-features" class="md-nav__link">
    Query features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-types_1" class="md-nav__link">
    Data Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managed-service" class="md-nav__link">
    Managed service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    Links
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>First</h1>

<p>I'm excited to introduce <a href="https://annadb.dev">AnnaDB</a> - the next-generation developer-first NoSQL data store.</p>
<p>I work with many small projects daily - proofs of concepts and experiments with new frameworks or patterns. For these purposes, I needed a database that works with flexible data structures, as I change it frequently during my experiments. And it must support relations out of the box, as this is a natural part of the structures' design - links to other objects. I tried a lot (if not all) databases, but nothing fit my requirements well. So, I decided to make my own then. This is how AnnaDB was born.</p>
<p>AnnaDB is an in-memory data store with disk persistence. It is written with Rust, a memory-safe compilable language. AnnaDB is fast and safe enough to be and the main data storage, and the cache layer.</p>
<p><strong>Features</strong></p>
<ul>
<li>Flexible object structure - simple primitives and complicated nested containers could be stored in AnnaDB</li>
<li>Relations - you can link any object to another, and AnnaDB will resolve this relation on finds, updates, and other operations.</li>
<li>Transactions - out of the box</li>
</ul>
<h2 id="basics">Basics</h2>
<p>I want to start with the basic concepts and examples of the syntax here and continue with the usage example.</p>
<h3 id="collections">Collections</h3>
<p>AnnaDB stores objects in collections. Collections are analogous to tables in SQL databases. </p>
<p>Every object and sub-object (item of a vector or map) that was stored in AnnaDB has a link (id). This link consists of the collection name and unique uuid4 value. One object can contain links to objects from any collections - AnnaDB will fetch and process them on all the operations automatically without additional commands (joins or lookups)</p>
<h3 id="tyson">TySON</h3>
<p>The AnnaDB query language uses the <code>TySON</code> format. The main difference from other data formats is that each item has a value and prefix. The prefix can mark the data or query type (as it is used in AnnaDB) or any other useful for the parser information. This adds more flexibility to the data structure design - it is allowed to use as many custom data types as the developer needs.</p>
<p>You can read more about the <code>TySON</code> format <a href="https://github.com/roman-right/tyson">here</a></p>
<h3 id="data-types">Data Types</h3>
<p>There are primitive and container data types in AnnaDB.</p>
<p>Primitive data types are a set of basic types whose values can not be decoupled. In TySON, primitives are represented as <code>prefix|value|</code> or <code>prefix</code> only. Prefix in AnnaDB shows the data type. For example, the string <code>test</code> will be represented as <code>s|test|</code>, where <code>s</code> - is a prefix that marks data as a string, and <code>test</code> is the actual value.</p>
<p>Container data types keep primitive and container objects using specific rules. There are only two container types in AnnaDB for now. Maps and vectors.</p>
<ul>
<li>Vectors are ordered sets of elements of any type. Example: <code>v[n|1|,n|2|,n|3|,]</code></li>
<li>Maps are associative arrays. Example: <code>m{ s|bar|: s|baz|,}</code></li>
</ul>
<p>More information about AnnaDB data types can be found in the <a href="https://annadb.dev/documentation/data_types/">documentation</a></p>
<h3 id="query">Query</h3>
<p>Query in AnnaDB is a pipeline of steps that should be applied in the order it was declared. The steps are wrapped into a vector with the prefix <code>q</code> - query.</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">test</span>|:<span class="prefix_vector">q</span>[
   <span class="prefix_vector">find</span>[
   ],
   <span class="prefix_vector">sort</span>[
      <span class="prefix_modifier">asc</span>(<span class="prefix_primitive">value</span>|<span class="value_primitive">num</span>|),
   ],
   <span class="prefix_modifier">limit</span>(<span class="prefix_number">n</span>|<span class="value_number">5</span>|),
];
</code></pre>

<p>If the pipeline has only one step, the <code>q</code> vector is not needed.</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">test</span>|:<span class="prefix_vector">find</span>[
   <span class="prefix_map">gt</span>{
      <span class="prefix_primitive">value</span>|<span class="value_primitive">num</span>|:<span class="prefix_number">n</span>|<span class="value_number">4</span>|,
   },
];
</code></pre>

<h3 id="server">Server</h3>
<p>To run AnnaDB locally please type the next command in the terminal:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>docker<span class="w"> </span>run<span class="w"> </span>--init<span class="w"> </span>-p<span class="w"> </span><span class="m">10001</span>:10001<span class="w"> </span>-t<span class="w"> </span>romanright/annadb:0.1.0
</code></pre></div>
<h3 id="client">Client</h3>
<p>AnnaDB shell client is an interactive terminal application that connects to the DB instance, validates and handles queries. It fits well to play with query language or work with the data manually.</p>
<p><img alt="AnnaDB shell" src="https://raw.githubusercontent.com/roman-right/AnnaDB/0c9f00f53f21184fe166c5c70d417f0ed4bcf01b/docs/build/assets/img/shell.png" /></p>
<p>It can be installed via <code>pip</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>pip<span class="w"> </span>install<span class="w"> </span>annadb
</code></pre></div>
<p>Run</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>annadb<span class="w"> </span>--uri<span class="w"> </span>annadb://localhost:10001
</code></pre></div>
<h2 id="usage-example">Usage example</h2>
<p>You are prepared for the fun part of the article now. Let's play with AnnaDB!</p>
<p>I'll create a database for the candy store to show the features.</p>
<h3 id="insert-primitive">Insert primitive</h3>
<p>Let's start with categories. I'll represent categories as simple string objects. Let's insert the first one into the <code>categories</code> collection.</p>
<p><strong>Request</strong>:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">categories</span>|:<span class="prefix_vector">insert</span>[
    <span class="prefix_string">s</span>|<span class="value_string">sweets</span>|,
];
</code></pre>

<p><code>collection|categories|</code> shows on which collection the query will be applied. In our case - <code>categories</code>.</p>
<p><code>insert[...]</code> - is a query step. You can insert one or many objects using the <code>insert</code> operation.</p>
<p><code>s|sweets|</code> - is the object to insert. In this case, it is a string primitive. Prefix <code>s</code> means that it is a string, <code>|</code> wrap the value of the primitive. Other primitive types could be found in the <a href="https://annadb.dev/documentation/data_types/">Data Types section</a>.</p>
<p><strong>Response</strong>:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_vector">ids</span>[
            <span class="prefix_link">categories</span>|<span class="value_link">88690111-62ad-4631-b12b-2a4fe7caa1cf</span>|,
        ],
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">insert_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">1</span>|,
        },
    },
];
</code></pre>

<p>If everything is ok, the result will have an <code>ok[...]</code> vector with responses for all the transaction pipelines. Each response contains <code>data</code> and <code>meta</code> information. In our case, there is only one response with a vector of <code>ids</code> in <code>data</code> and a number of inserted objects in <code>meta</code>.</p>
<h3 id="insert-container">Insert container</h3>
<p>Let's insert a more complicated object now - a chocolate bar. It will have fields:</p>
<ul>
<li>name</li>
<li>price</li>
<li>category</li>
</ul>
<p>For the category, I'll use the already created one.</p>
<p><strong>Request</strong>:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">products</span>|:<span class="prefix_vector">insert</span>[
    <span class="prefix_map">m</span>{
        <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Tony's</span>|,
        <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">5.95</span>|,
        <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_link">categories</span>|<span class="value_link">88690111-62ad-4631-b12b-2a4fe7caa1cf</span>|,
    },
];
</code></pre>

<p>The query is similar to the previous one, but the object is not a primitive but a map. The value of the <code>category</code> field is a link that was received after the previous insert.</p>
<p><strong>Response</strong>:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_vector">ids</span>[
            <span class="prefix_link">products</span>|<span class="value_link">91f5236c-e4cd-43c7-af5b-7534e5ba2c32</span>|,
        ],
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">insert_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">1</span>|,
        },
    },
];
</code></pre>

<p>The response is nearly the same as before - link in data and number of inserted objects in meta.</p>
<h3 id="get-object">Get object</h3>
<p>Let's retrieve the information about this chocolate bar now. I'll use the <code>get</code> operation for this, to the object by id</p>
<p><strong>Request</strong>:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">products</span>|:<span class="prefix_vector">get</span>[
    <span class="prefix_link">products</span>|<span class="value_link">91f5236c-e4cd-43c7-af5b-7534e5ba2c32</span>|,
];
</code></pre>

<p>This time I use the <code>get[...]</code> query step. Using this step you can retrieve one or many objects using object links.</p>
<p><strong>Response</strong>:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_map">objects</span>{
            <span class="prefix_link">products</span>|<span class="value_link">91f5236c-e4cd-43c7-af5b-7534e5ba2c32</span>|:<span class="prefix_map">m</span>{
                <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Tony's</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_string">s</span>|<span class="value_string">sweets</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">5.95</span>|,
            },
        },
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">get_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">1</span>|,
        },
    },
];
</code></pre>

<p>In the response here you can see the <code>objects{...}</code> map, where keys are links to objects and values are objects. <code>objects{}</code> map keeps the order - it will return objects in the same order as they were requested in the get step, or as they were sorted by the sort step.</p>
<p>The category was fetched automatically and the value was returned.</p>
<p>Let's insert another chocolate bar there to have more objects in the collection:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">products</span>|:<span class="prefix_vector">insert</span>[
    <span class="prefix_map">m</span>{
        <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Mars</span>|,
        <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">2</span>|,
        <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_link">categories</span>|<span class="value_link">88690111-62ad-4631-b12b-2a4fe7caa1cf</span>|,
    },
];
</code></pre>

<p>I use the same category id for this bar.</p>
<h3 id="modify-primitive">Modify primitive</h3>
<p>Let's modify the category to make it more accurate.</p>
<p><strong>Request</strong>:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">categories</span>|:<span class="prefix_vector">q</span>[
    <span class="prefix_vector">get</span>[
        <span class="prefix_link">categories</span>|<span class="value_link">88690111-62ad-4631-b12b-2a4fe7caa1cf</span>|,
    ],
    <span class="prefix_vector">update</span>[
        <span class="prefix_map">set</span>{
            <span class="prefix_primitive">root</span>:<span class="prefix_string">s</span>|<span class="value_string">chocolate</span>|,
        },
    ],
];
</code></pre>

<p>The query here consists of 2 steps. <code>Get the object by link</code> step and <code>modify this object</code> step. The <code>update[...]</code> operation is a vector of update operators. <a href="https://annadb.dev/documentation/update/">Read more about the update</a>.</p>
<p><strong>Response</strong>:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_vector">ids</span>[
            <span class="prefix_link">categories</span>|<span class="value_link">88690111-62ad-4631-b12b-2a4fe7caa1cf</span>|,
        ],
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">update_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">1</span>|,
        },
    },
];
</code></pre>

<p>The response of the update operation contains the ids of the updated objects as data and the number of the updated objects as meta.</p>
<p>Let's take a look at how this affected the chocolate objects.</p>
<p><strong>Request</strong>:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">products</span>|:<span class="prefix_vector">find</span>[
];
</code></pre>

<p>To find objects, I use the <code>find[...]</code> operation. It is a vector of find operators. If it is empty, all the collection objects will be returned.</p>
<p><strong>Response</strong>:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_map">objects</span>{
            <span class="prefix_link">products</span>|<span class="value_link">02a2a5cd-0c56-45f7-8cad-7838446cfc49</span>|:<span class="prefix_map">m</span>{
                <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Mars</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_string">s</span>|<span class="value_string">chocolate</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">2</span>|,
            },
            <span class="prefix_link">products</span>|<span class="value_link">91f5236c-e4cd-43c7-af5b-7534e5ba2c32</span>|:<span class="prefix_map">m</span>{
                <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">5.95</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Tony's</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_string">s</span>|<span class="value_string">chocolate</span>|,
            },
        },
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">find_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">2</span>|,
        },
    },
];
</code></pre>

<p>The category was changed for both products, as the category object was linked with these objects.</p>
<h3 id="modify-container">Modify container</h3>
<p>Now I'll increase the price of the bars, where it is less than 2</p>
<p><strong>Request</strong>:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">products</span>|:<span class="prefix_vector">q</span>[
    <span class="prefix_vector">find</span>[
        <span class="prefix_map">lt</span>{
            <span class="prefix_primitive">value</span>|<span class="value_primitive">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">3</span>|,
        },
    ],
    <span class="prefix_vector">update</span>[
        <span class="prefix_map">inc</span>{
            <span class="prefix_primitive">value</span>|<span class="value_primitive">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">2</span>|,
        },
    ],
];
</code></pre>

<p>The <code>find</code> step can stay before the <code>update</code> step as well. All the found objects will be updated. Read more about <code>find</code> operation and operators <a href="https://annadb.dev/documentation/find/">here</a>.</p>
<p><strong>Response</strong>:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_vector">ids</span>[
            <span class="prefix_link">products</span>|<span class="value_link">02a2a5cd-0c56-45f7-8cad-7838446cfc49</span>|,
        ],
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">update_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">1</span>|,
        },
    },
];
</code></pre>

<p>The response is similar to the previous one.</p>
<p>Here is how all the products look like after the update:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_map">objects</span>{
            <span class="prefix_link">products</span>|<span class="value_link">02a2a5cd-0c56-45f7-8cad-7838446cfc49</span>|:<span class="prefix_map">m</span>{
                <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Mars</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">4</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_string">s</span>|<span class="value_string">chocolate</span>|,
            },
            <span class="prefix_link">products</span>|<span class="value_link">91f5236c-e4cd-43c7-af5b-7534e5ba2c32</span>|:<span class="prefix_map">m</span>{
                <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_string">s</span>|<span class="value_string">chocolate</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">5.95</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Tony's</span>|,
            },
        },
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">find_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">2</span>|,
        },
    },
];
</code></pre>

<h3 id="sort-objects">Sort objects</h3>
<p>To sort objects, I'll use the <code>sort</code> operation against the price field.</p>
<p><strong>Request</strong>:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">products</span>|:<span class="prefix_vector">q</span>[
    <span class="prefix_vector">find</span>[
    ],
    <span class="prefix_vector">sort</span>[
        <span class="prefix_modifier">asc</span>(<span class="prefix_primitive">value</span>|<span class="value_primitive">price</span>|),
    ],
];
</code></pre>

<p>The <code>sort[...]</code> operation is a vector of sort operators - <code>asc</code> and <code>desc</code>. Sort operators are modifiers that contain paths to the sorting value. The <code>sort</code> operation is not an independent step, it can stay only after find-like operations that return objects. You can read more about sort <a href="https://annadb.dev/documentation/update/">here</a></p>
<p><strong>Response</strong>:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_map">objects</span>{
            <span class="prefix_link">products</span>|<span class="value_link">02a2a5cd-0c56-45f7-8cad-7838446cfc49</span>|:<span class="prefix_map">m</span>{
                <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Mars</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">4</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_string">s</span>|<span class="value_string">chocolate</span>|,
            },
            <span class="prefix_link">products</span>|<span class="value_link">91f5236c-e4cd-43c7-af5b-7534e5ba2c32</span>|:<span class="prefix_map">m</span>{
                <span class="prefix_string">s</span>|<span class="value_string">category</span>|:<span class="prefix_string">s</span>|<span class="value_string">chocolate</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">name</span>|:<span class="prefix_string">s</span>|<span class="value_string">Tony's</span>|,
                <span class="prefix_string">s</span>|<span class="value_string">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">5.95</span>|,
            },
        },
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">find_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">2</span>|,
        },
    },
];
</code></pre>

<p>Objects in the response are sorted by price now.</p>
<p>It is useful to use <code>limit</code> and <code>offset</code> operations together with sort. You can read about them in the <a href="https://annadb.dev/documentation/limit/">documentation</a></p>
<h3 id="delete-objects">Delete objects</h3>
<p>After any find-like step, you can use the <code>delete</code> operation to delete all the found objects. Or it can be used independently to delete the whole collection.</p>
<p><strong>Request</strong>:</p>
<pre><code><span class="prefix_primitive">collection</span>|<span class="value_primitive">products</span>|:<span class="prefix_vector">q</span>[
    <span class="prefix_vector">find</span>[
        <span class="prefix_map">gt</span>{
            <span class="prefix_primitive">value</span>|<span class="value_primitive">price</span>|:<span class="prefix_number">n</span>|<span class="value_number">5</span>|,
        },
    ],
    <span class="prefix_primitive">delete</span>,
];
</code></pre>

<p>The <code>delete</code> operation is a primitive without value.</p>
<p><strong>Response</strong>:</p>
<pre><code><span class="prefix_primitive">result</span>:<span class="prefix_vector">ok</span>[
    <span class="prefix_map">response</span>{
        <span class="prefix_string">s</span>|<span class="value_string">data</span>|:<span class="prefix_vector">ids</span>[
            <span class="prefix_link">products</span>|<span class="value_link">91f5236c-e4cd-43c7-af5b-7534e5ba2c32</span>|,
        ],
        <span class="prefix_string">s</span>|<span class="value_string">meta</span>|:<span class="prefix_map">update_meta</span>{
            <span class="prefix_string">s</span>|<span class="value_string">count</span>|:<span class="prefix_number">n</span>|<span class="value_number">1</span>|,
        },
    },
];
</code></pre>

<p>The response contains affected ids in <code>data</code> and the number of deleted objects in <code>meta</code>.</p>
<h2 id="using-from-your-app">Using from your app</h2>
<p>AnnaDB has a Python driver. It has an internal query builder - you don't need to learn AnnaDB query syntax to work with it. But it supports raw querying too.</p>
<ul>
<li><a href="https://pypi.org/project/annadb/">Link to the PyPI repo</a></li>
<li><a href="https://annadb.dev/tutorial/python/">Python tutorial</a></li>
</ul>
<p>I'll add drivers for other languages soon. If you can help me with it, I'll be more than happy :)</p>
<h2 id="plans">Plans</h2>
<p>This is the very early version of the database. It can already do things, and I use it in a few of my projects. But there are many features to work on yet.</p>
<h3 id="drivers">Drivers</h3>
<p>I plan to add drivers to support the most popular languages, like <code>JS</code>, <code>Rust</code>, <code>Go</code>, and others. If you can help with this - please get in touch with me.</p>
<h3 id="rights-management">Rights management</h3>
<p>This is probably the most important feature to implement. Authentication, authorizations, roles, etc.</p>
<h3 id="performance-increase">Performance increase</h3>
<p>There are many performance-related things to improve now. </p>
<h3 id="query-features">Query features</h3>
<ul>
<li>Projections</li>
<li>More find and update operators</li>
<li>Developer experience improves</li>
</ul>
<h3 id="data-types_1">Data Types</h3>
<p>I plan to add more data types like geo points and graph vertices to make AnnaDB more comfortable working with different data fields.</p>
<h3 id="managed-service">Managed service</h3>
<p>My big goal is to make a managed data store service. Hey, AWS, Google Cloud, MS Azure, I'm ready for collaborations! ;)</p>
<h2 id="links">Links</h2>
<ul>
<li>Documentation - <a href="https://annadb.dev">https://annadb.dev</a></li>
<li>GitHub Repo - <a href="https://github.com/roman-right/AnnaDB">https://github.com/roman-right/AnnaDB</a></li>
<li>Python Driver - <a href="https://pypi.org/project/annadb/">https://pypi.org/project/annadb/</a></li>
<li>My Twitter - <a href="https://twitter.com/roman_the_right">https://twitter.com/roman_the_right</a></li>
</ul>
<p><em>If you face any bug or weird behavior, please, let me know.</em></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.407015b8.min.js"></script>
      
    
  </body>
</html>